{
    "schemes": [
        "http",
        "https"
    ],
    "swagger": "2.0",
    "info": {
        "description": "API specification for the Authenticated Anonymity Architecture (AAA), a blockchain-based solution providing robust and ethical authenticated anonymous identities with deanonymization capabilities for criminal activity cases.",
        "title": "National Identity Provider (NIP)",
        "contact": {
            "name": "Michele Dinelli",
            "email": "m.dinelli@unibo.it"
        },
        "license": {
            "name": "Apache 2.0",
            "url": "http://www.apache.org/licenses/LICENSE-2.0.html"
        },
        "version": "0.0.1"
    },
    "host": "localhost:8888",
    "basePath": "/",
    "paths": {
        "/v1/auth/pac": {
            "post": {
                "description": "Allows a user to request a Public Authentication Code (PAC) from the NIP. It's used to authenticate the user as an identified user in the system without sharing any information about her identity. The user sends a message to the NIP containing `SIGN(PID, SK)`, namely the PID signed with the private key of the public-private key pair used to obtain the PID. The NIP verifies that the user is indeed the key holder and returns the PAC, saving it in its local repository. When logging onto the public service, the user can show the PAC, and the service has only to query the NIP to verify that the code is associated with an authenticated user.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "auth"
                ],
                "summary": "PAC issuance request",
                "parameters": [
                    {
                        "description": "PAC Request Model",
                        "name": "models.PACRequestModel",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/models.PACRequestModel"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "The Public Authentication Code",
                        "schema": {
                            "$ref": "#/definitions/models.PACResponseModel"
                        }
                    },
                    "400": {
                        "description": "Bad request",
                        "schema": {
                            "$ref": "#/definitions/models.ErrorResponseModel"
                        }
                    },
                    "404": {
                        "description": "Not found",
                        "schema": {
                            "$ref": "#/definitions/models.ErrorResponseModel"
                        }
                    },
                    "500": {
                        "description": "An error occurred",
                        "schema": {
                            "$ref": "#/definitions/models.ErrorResponseModel"
                        }
                    }
                }
            }
        },
        "/v1/auth/sac": {
            "post": {
                "description": "The SAC (Secret Authentication Code) is a one-time code used to authenticate the user as an anonymous user, at the same time guaranteeing that a real user—one that has been registered within the system—exists behind the anonymous identity. To obtain the SAC, the user queries the NIP by sending a message containing `ENC(SID, SK)`, i.e., her SID signed with the private key associated with the public key saved on the blockchain at the moment of seed phrase creation and used in the record where the SID was stored. The NIP retrieves the SID record from the blockchain and checks that it was actually signed by that user via the PK saved in the record. This certifies that the user is the true owner of that SID.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "auth"
                ],
                "summary": "SAC issuance request",
                "parameters": [
                    {
                        "description": "SAC Request Model",
                        "name": "models.SACRequestModel",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/models.SACRequestModel"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "The Secret Authentication Code",
                        "schema": {
                            "$ref": "#/definitions/models.SACResponseModel"
                        }
                    },
                    "400": {
                        "description": "Bad request",
                        "schema": {
                            "$ref": "#/definitions/models.ErrorResponseModel"
                        }
                    },
                    "500": {
                        "description": "An error occurred",
                        "schema": {
                            "$ref": "#/definitions/models.ErrorResponseModel"
                        }
                    }
                }
            }
        },
        "/v1/auth/verify-pac": {
            "post": {
                "description": "Allows a user to verify a PAC (Public Authentication Code) for services accepting an authenticated anonymous identity.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "auth"
                ],
                "summary": "PAC verification request",
                "parameters": [
                    {
                        "description": "PAC Verification Request Model",
                        "name": "models.PACVerificationRequestModel",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/models.PACVerificationRequestModel"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "The Public Authentication Code Verification Response",
                        "schema": {
                            "$ref": "#/definitions/models.PACVerificationResponseModel"
                        }
                    },
                    "400": {
                        "description": "Bad request",
                        "schema": {
                            "$ref": "#/definitions/models.ErrorResponseModel"
                        }
                    },
                    "404": {
                        "description": "Not found",
                        "schema": {
                            "$ref": "#/definitions/models.ErrorResponseModel"
                        }
                    },
                    "500": {
                        "description": "An error occurred",
                        "schema": {
                            "$ref": "#/definitions/models.ErrorResponseModel"
                        }
                    }
                }
            }
        },
        "/v1/identity/pid": {
            "post": {
                "description": "The NIP issues a Public Identity Data (PID), i.e., an anonymous token that identifies the user without explicitly sharing information, saves it on its local database, and shares it with the user. The real identity of the user is carried by the PID alone, since it has been officially issued by an NIP that verified the identity of the user. Additionally, the NIP will be the only one able to connect a PID to the real information of the respective user.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "identity"
                ],
                "summary": "PID issuance request",
                "parameters": [
                    {
                        "description": "PID Request Model",
                        "name": "models.PIDRequestModel",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/models.PIDRequestModel"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "The PID",
                        "schema": {
                            "$ref": "#/definitions/models.PIDResponseModel"
                        }
                    },
                    "400": {
                        "description": "Bad request",
                        "schema": {
                            "$ref": "#/definitions/models.ErrorResponseModel"
                        }
                    },
                    "500": {
                        "description": "An error occurred",
                        "schema": {
                            "$ref": "#/definitions/models.ErrorResponseModel"
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "models.ErrorResponseModel": {
            "type": "object",
            "properties": {
                "code": {
                    "type": "integer"
                },
                "message": {
                    "type": "string"
                }
            }
        },
        "models.PACRequestModel": {
            "type": "object",
            "required": [
                "pid",
                "signed_pid"
            ],
            "properties": {
                "pid": {
                    "type": "string",
                    "example": "DmIq8x2JNs+E2qGBr16LxP6lUK+i/5nJRLuzvYEymtY="
                },
                "signed_pid": {
                    "type": "string",
                    "example": "fzLD1/PAJoq7EtWqIXLOYMhxNJCK9L4w4yniXZSxu0r3+oZ84jreOAhAIlrodSdg0/4EaKYWLmyf0D0uD0eozzwhvVYPDZIrLSxllH+HeEWWuOm1hnPVOOUwo7G4ROemojqwNQ6uvSB+AxoAPiSfm01Rgi0BPoaH9X8H6r94O9Hm3ZrgA9zoxQhMTx/eDpsW2yNbfPFXd18IAuHqLJSCBOSl3U4PfHEad3xFw6H04s2hr3Rqlsb2WsJmS6rf0mPEPAKjq1fSvBIcxg6PCJdfw/GhZEByrP0qc5DllkYSYZaddM/pAh+8LA16YmN1eO9VthsQxGt/WHma/5xsChOaCMd+fgk+Yjio56LoHrC86SqKsS4gkfa2jZoyagwNCah/nKAQkeVzQjk5+WLdCfMh71v82lw9L3rwlng2KhLC4z19k7wheoKQipJaxFR72T7PDftt1TvttK5q6F8x+sV6cTC6roRkgZG03X4tgLJrkBLjF9w3KbcKhPzLyu9ehYtTqFe9hBuR11UXirTi96bvmT9wWDVoTxv+ZGvn59e0VLBcQp67W2m3CZgmIs5eksQPhsFufRwYq49kXxFqnX5OZdqmVVhbQM8X9b8dTpgxd+tIuPzrYcG3ts5ApPCdXMoM/s1Tp6x+QQtq6uOD44V5v5E9tHd9GAH5cYKDfPvdA/w="
                }
            }
        },
        "models.PACResponseModel": {
            "type": "object",
            "properties": {
                "expiration": {
                    "type": "string",
                    "example": "2024-12-31T23:59:59Z"
                },
                "pac": {
                    "type": "integer",
                    "example": 874532
                }
            }
        },
        "models.PACVerificationRequestModel": {
            "type": "object",
            "required": [
                "pac",
                "pid"
            ],
            "properties": {
                "pac": {
                    "type": "integer",
                    "example": 874532
                },
                "pid": {
                    "type": "string",
                    "example": "DmIq8x2JNs+E2qGBr16LxP6lUK+i/5nJRLuzvYEymtY="
                }
            }
        },
        "models.PACVerificationResponseModel": {
            "type": "object",
            "properties": {
                "expiration": {
                    "type": "string",
                    "example": "2024-12-31T23:59:59Z"
                },
                "valid": {
                    "type": "boolean",
                    "example": true
                }
            }
        },
        "models.PIDRequestModel": {
            "type": "object",
            "required": [
                "public_key"
            ],
            "properties": {
                "public_key": {
                    "type": "string",
                    "example": "abc123def456ghci78"
                }
            }
        },
        "models.PIDResponseModel": {
            "type": "object",
            "properties": {
                "message": {
                    "type": "string",
                    "example": "PID successfully issued and saved"
                },
                "pid": {
                    "type": "string",
                    "example": "a1b2c3d4-e5f6-7890-1234-567890abcdef"
                }
            }
        },
        "models.SACRequestModel": {
            "type": "object",
            "properties": {
                "signed_sid": {
                    "type": "string",
                    "example": "signed_sid_payload_base64"
                }
            }
        },
        "models.SACResponseModel": {
            "type": "object",
            "properties": {
                "sac": {
                    "type": "string",
                    "example": "abc123def456ghci78"
                }
            }
        }
    }
}